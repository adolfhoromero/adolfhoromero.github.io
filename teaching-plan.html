<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ILRLR 1100 • Interactive Discussion Hub</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&family=Spectral:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0b0e14; --fg:#e9eef6; --muted:#9fb0c6; --card:#131826; --accent:#3b82f6; --accent2:#fbbf24; --ok:#10b981; --warn:#f59e0b; --err:#ef4444;
  }
  *{box-sizing:border-box}
  html,body{margin:0;height:100%;background:var(--bg);color:var(--fg);font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  a{color:var(--accent)}
  .wrap{max-width:1150px;margin:24px auto;padding:0 16px}
  h1{font-family:Spectral,serif;font-weight:800;letter-spacing:.2px;margin:.2rem 0 1rem;font-size:clamp(1.6rem,3.3vw,2.6rem)}
  .bar{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .pill{background:linear-gradient(90deg,var(--accent),#6366f1);padding:6px 12px;border-radius:999px;font-weight:700;font-size:.9rem}
  .lang{margin-left:auto;display:flex;gap:8px}
  .lang button{background:var(--card);color:var(--fg);border:1px solid #283149;border-radius:10px;padding:6px 10px;cursor:pointer}
  .lang button[aria-pressed="true"]{outline:2px solid var(--accent)}
  .grid{display:grid;grid-template-columns:320px 1fr;gap:18px}
  @media(max-width:980px){.grid{grid-template-columns:1fr}}

  /* LEFT: controls */
  .panel{background:var(--card);border:1px solid #1f2638;border-radius:16px;padding:14px;position:sticky;top:10px;height:max-content}
  .panel h2{margin:.2rem 0 8px;font-size:1.1rem}
  .panel label{display:block;font-size:.9rem;color:var(--muted);margin:.6rem 0 .2rem}
  .panel input[type=range]{width:100%}
  .panel .row{display:flex;gap:8px;flex-wrap:wrap}
  .btn{background:#1c2436;border:1px solid #23304b;color:var(--fg);padding:8px 12px;border-radius:10px;cursor:pointer}
  .btn.primary{background:linear-gradient(90deg,var(--accent),#6366f1);border:none}
  .btn.gold{background:linear-gradient(90deg,var(--accent2,#fbbf24),#f59e0b);border:none;color:#111}
  .note{color:var(--muted);font-size:.9rem}

  /* RIGHT: interactive canvas */
  .canvas{display:grid;gap:14px}

  /* Week cards */
  .weeks{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}
  .week{position:relative;perspective:900px;height:360px}
  .card{position:absolute;inset:0;border-radius:16px;background:radial-gradient(1000px 400px at 20% -10%,rgba(59,130,246,.25),transparent),radial-gradient(800px 260px at 110% 100%,rgba(251,191,36,.18),transparent),var(--card);border:1px solid #25314c;box-shadow:0 24px 70px rgba(0,0,0,.25);transform-style:preserve-3d;transition:transform .25s ease, box-shadow .25s ease}
  .card:hover{box-shadow:0 28px 90px rgba(0,0,0,.42)}
  .card-inner{padding:14px 14px 12px;display:flex;flex-direction:column;height:100%}
  .title{display:flex;align-items:center;gap:10px}
  .title b{font-size:1.05rem}
  .chip{font-size:.75rem;background:rgba(255,255,255,.08);border:1px solid #2b3755;padding:3px 7px;border-radius:999px;color:#dfe8ff}
  .meta{color:var(--muted);font-size:.85rem;margin:.25rem 0 .35rem}
  .agenda, .actions{margin-top:.35rem}
  .agenda li{margin:.3rem 0}
  .actions{margin-top:auto;display:flex;gap:8px;flex-wrap:wrap}

  /* Back face */
  .card-back{position:absolute;inset:0;border-radius:16px;background:linear-gradient(160deg,#0f172a 0%,#1e293b 100%);border:1px solid #2b3755;transform:rotateY(180deg);backface-visibility:hidden;padding:16px;display:flex;flex-direction:column}
  .card-front{backface-visibility:hidden}
  .flip{transform:rotateY(180deg)}

  .q{background:#111827;border:1px solid #283149;border-radius:12px;padding:10px;margin:.3rem 0}
  .q h4{margin:0 0 .4rem}
  .q .opt{display:block;margin:.25rem 0;padding:6px 8px;border-radius:8px;border:1px solid #24304c;background:#0b1020;cursor:pointer}
  .q .opt.correct{border-color:var(--ok)}
  .q .opt.wrong{border-color:var(--err)}
  .q .feedback{font-size:.9rem;color:var(--muted);margin-top:.4rem}

  /* Debate spinner */
  .spinner{position:relative;height:220px;background:#0e1424;border:1px dashed #2b3755;border-radius:16px;display:grid;place-items:center;overflow:hidden}
  .spin-needle{position:absolute;top:0;left:50%;transform:translateX(-50%);width:0;height:0;border-left:10px solid transparent;border-right:10px solid transparent;border-bottom:18px solid var(--accent2)}
  .wheel{width:280px;height:280px;border-radius:50%;border:1px solid #2b3755;background:conic-gradient(#22304a 0 25%, #1a2440 0 50%, #22304a 0 75%, #1a2440 0 100%);display:grid;place-items:center;transition:transform 3.2s cubic-bezier(.17,.67,.23,1.23)}
  .wheel .slot{position:absolute;font-size:.9rem;color:#cdd8f5}
  .wheel .slot:nth-child(1){transform:rotate(0deg) translateY(-110px)}
  .wheel .slot:nth-child(2){transform:rotate(90deg) translateY(-110px)}
  .wheel .slot:nth-child(3){transform:rotate(180deg) translateY(-110px)}
  .wheel .slot:nth-child(4){transform:rotate(270deg) translateY(-110px)}

  /* Evidence board */
  .board{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
  @media(max-width:720px){.board{grid-template-columns:1fr}}
  .drop{min-height:90px;border:1px dashed #40507a;border-radius:12px;padding:8px;background:#0d1426}
  .drag{display:inline-block;margin:6px 6px 0 0;background:#16203a;border:1px solid #2b3755;border-radius:10px;padding:6px 8px;cursor:grab}
  .drag:active{cursor:grabbing}

  /* Progress tracker */
  .progress{display:flex;gap:8px;align-items:center}
  .progress meter{width:140px}
  .tag{display:inline-flex;align-items:center;gap:6px;font-size:.85rem;background:#0d1426;border:1px solid #2b3755;padding:4px 8px;border-radius:999px}

  /* Toast */
  .toast{position:fixed;right:16px;bottom:16px;background:#111827;border:1px solid #283149;padding:10px 12px;border-radius:10px;opacity:0;transform:translateY(10px);transition:all .3s}
  .toast.show{opacity:1;transform:translateY(0)}
</style>
</head>
<body>
  <div class="wrap">
    <div class="bar">
      <h1>ILRLR 1100 • Interactive Discussion Hub <span class="pill">Beta</span></h1>
      <div class="lang" role="group" aria-label="Language">
        <button id="enBtn" aria-pressed="true">English</button>
        <button id="esBtn" aria-pressed="false">Español</button>
      </div>
    </div>

    <div class="grid">
      <!-- Controls Panel -->
      <aside class="panel" aria-label="Controls">
        <h2>Playground</h2>
        <label>Filter by date</label>
        <!-- The max attribute will be updated by script to match the number of weeks -->
        <input type="range" id="weekRange" min="1" max="6" value="6" />
        <div class="row"><span class="tag"><strong id="rangeLabel">All weeks</strong></span></div>

        <label>Focus</label>
        <div class="row">
          <button class="btn" data-focus="all">All</button>
          <button class="btn" data-focus="activities">Activities</button>
          <button class="btn" data-focus="readings">Readings</button>
          <button class="btn" data-focus="assessment">Assessment</button>
        </div>

        <label>Mini games</label>
        <div class="row">
          <button id="spinBtn" class="btn gold">Debate spinner</button>
          <button id="resetLocal" class="btn">Reset progress</button>
        </div>
        <p class="note">Tip: Click a week card to flip for quizzes & prompts. Drag quotes into the evidence board. Your progress saves locally.</p>
      </aside>

      <!-- Interactive Canvas -->
      <main class="canvas">
        <!-- Progress Strip -->
        <section class="progress">
          <meter id="progressMeter" min="0" max="100" low="25" high="75" optimum="90" value="0"></meter>
          <span id="progressText" class="tag">0% complete</span>
        </section>

        <!-- Debate Spinner -->
        <section class="spinner" aria-live="polite" aria-label="Debate spinner">
          <div class="spin-needle" aria-hidden="true"></div>
          <div class="wheel" id="wheel">
            <div class="slot">Evidence</div>
            <div class="slot">Counter-argument</div>
            <div class="slot">Historical link</div>
            <div class="slot">Modern policy</div>
          </div>
        </section>

        <!-- Weeks -->
        <section class="weeks" id="weeks"></section>

        <!-- Evidence Board -->
        <section>
          <h2 style="font-size:1.3rem;margin:.6rem 0">Evidence board</h2>
          <div class="board" id="board">
            <div class="drop" data-slot="evidence" aria-label="Evidence"></div>
            <div class="drop" data-slot="analysis" aria-label="Analysis"></div>
            <div class="drop" data-slot="connection" aria-label="Connection"></div>
          </div>
          <p class="note">Drag quote chips from week backs here to plan paragraphs.</p>
        </section>
      </main>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

<script>
// ===== Data (seeded from your plan; extend as needed) =====
const data = [
  { id:1, date:'Aug 31', title:'Introductions • Syllabus • History Timeline', tags:['activities','readings'], 
    agenda:[
      'Welcome & expectations, office hours, laptop policy',
      'History Timeline group activity with Everything Poll',
      'Groups: Lincoln on labor; Statute of Laborers (1351); Peasants’ Revolt (1381); Combination Acts (1799–1800); Qatar World Cup deaths piece'
    ],
    quiz:{ q:'Which source anchors a medieval labour control law?', opts:[
      {t:'Combination Acts (1799–1800)', ok:false},
      {t:'Statute of Laborers (1351)', ok:true},
      {t:'Peasants\' Revolt (1381)', ok:false}
    ]},
    quotes:[
      '“Wage controls and mobility limits illuminate power after plague.”',
      '“Revolt as tradition: 1381 to modern labour claims.”'
    ]
  },
  { id:2, date:'Sept 6', title:'Clotilda reflection • Rediker, The Slave Ship', tags:['activities','readings','assessment'],
    agenda:[
      'Play Clotilda documentary snippet as students arrive',
      'Discuss Middle Passage phases; roles of pirates and sailors',
      'Equiano & Newton; labour vs capital through maritime tech'
    ],
    quiz:{ q:'Rediker splits the Middle Passage into…', opts:[
      {t:'Capture & Emancipation', ok:false},
      {t:'Shore-side procurement & Atlantic crossing', ok:true},
      {t:'Embarkation & Industrialization', ok:false}
    ]},
    quotes:[
      '“The ship is a factory of unfreedom and profit.”',
      '“Sailors’ solidarities fluctuate with discipline and pay.”'
    ]
  },
  { id:3, date:'Sept 13', title:'Reading strategies • Race formation across texts', tags:['activities','assessment'],
    agenda:[
      'Admin updates; Synthesis essay Q&A',
      'How to read dense texts: pacing & annotation drill',
      'Quiz #3: race in the New World; Naturalization Act; class structures'
    ],
    quiz:{ q:'Which 1790 law limited citizenship to “free white persons”?', opts:[
      {t:'Naturalization Act', ok:true},{t:'Alien and Sedition Acts', ok:false},{t:'Homestead Act', ok:false}
    ]},
    quotes:['“Law manufactures race, not just reflects it.”']
  },
  { id:4, date:'Sept 19', title:'Peer review • Evidence check • Outline clinic', tags:['assessment','activities'],
    agenda:[
      'Debrief guest visit; office hours reminder',
      'Underline every “evidence unit” in a partner draft',
      'Outline swap: thesis-thread-audit against prompt parts'
    ],
    quiz:{ q:'Strong evidence integration requires…', opts:[
      {t:'Quote density over clarity', ok:false},
      {t:'Context → Evidence → Analysis chain', ok:true},
      {t:'Assuming readers know the source', ok:false}
    ]},
    quotes:['“Name the move: context → quote → why it matters.”']
  },
  { id:5, date:'Sept 27', title:'Lowell Mill Girls • Black Folk • CTP compare', tags:['readings','activities'],
    agenda:[
      'Short film: Lowell — The Continuing Revolution',
      'Women’s first unions; dignity & agency in factories',
      'CTP: compare early mills to Bangladesh today; why labour law and unions'
    ],
    quiz:{ q:'In Lowell discussions, “subtle language” mattered because…', opts:[
      {t:'It avoided any conflict with owners forever', ok:false},
      {t:'It coded demands within acceptable gender norms', ok:true},
      {t:'It replaced collective action', ok:false}
    ]},
    quotes:[
      '“Household skills became wage leverage and freedom.”',
      '“Moral claims reframed productivity and care.”'
    ]
  },
  { id:6, date:'Oct 4', title:'Homestead setup • John Due • Peer‑review drill', tags:['readings','activities','assessment'],
    agenda:[
      'Essay grades logistics; celebrate John D. Due',
      'Dockworkers clip: unions & global leverage',
      'Peer‑review excerpts; Debate setup: Homestead 1892'
    ],
    quiz:{ q:'A debate prompt should push which habit most?', opts:[
      {t:'Trading facts without warrants', ok:false},
      {t:'Advancing claims with sourced warrants and counter‑moves', ok:true},
      {t:'Reading prompts aloud only', ok:false}
    ]},
    quotes:['“Strike politics link shop‑floor power to law and media.”']
  }
];

// ===== Utility =====
const $ = sel => document.querySelector(sel);
const $$ = sel => Array.from(document.querySelectorAll(sel));
function toast(msg){ const t=$('#toast'); t.textContent=msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),1800) }
function save(k,v){ localStorage.setItem(k, JSON.stringify(v)) }
function load(k, d){ try{ return JSON.parse(localStorage.getItem(k)) ?? d }catch{ return d } }

// ===== Render Weeks =====
const weeksEl = $('#weeks');
function renderWeeks(maxId=Infinity){
  weeksEl.innerHTML='';
  data.filter(w=>w.id<=maxId).forEach(w=>{
    const wrap=document.createElement('div'); wrap.className='week'; wrap.dataset.id=w.id;
    wrap.innerHTML=`
      <div class="card card-front" aria-label="Week card" tabindex="0">
        <div class="card-inner">
          <div class="title"><b>Week ${w.id} • ${w.date}</b> <span class="chip">${w.tags.join(' · ')}</span></div>
          <div class="meta">${w.title}</div>
          <ul class="agenda">${w.agenda.map(a=>`<li>${a}</li>`).join('')}</ul>
          <div class="actions">
            <button class="btn primary act-flip">Open activities</button>
            <button class="btn act-done">Mark done</button>
          </div>
        </div>
      </div>
      <div class="card card-back" aria-hidden="true">
        <div class="title"><b>Week ${w.id} • Quiz & Prompts</b></div>
        <div class="q">
          <h4>${w.quiz.q}</h4>
          ${w.quiz.opts.map((o,i)=>`<button class="opt" data-ok="${o.ok}">${String.fromCharCode(65+i)}. ${o.t}</button>`).join('')}
          <div class="feedback"></div>
        </div>
        <div>
          <b style="display:block;margin:.6rem 0 .2rem">Drag‑to‑board quotes</b>
          ${w.quotes.map(q=>`<span class="drag" draggable="true">${q}</span>`).join('')}
        </div>
        <div class="actions" style="margin-top:10px">
          <button class="btn act-back">Back</button>
          <button class="btn" onclick="window.print()">Print</button>
        </div>
      </div>`;
    weeksEl.appendChild(wrap);
  });
  bindWeekEvents();
  applyTilt();
}

function bindWeekEvents(){
  $$('.act-flip').forEach(b=> b.onclick = e=> e.currentTarget.closest('.week').querySelector('.card-front').classList.add('flip'));
  $$('.act-back').forEach(b=> b.onclick = e=> e.currentTarget.closest('.week').querySelector('.card-front').classList.remove('flip'));
  $$('.act-done').forEach(b=> b.onclick = e=>{
    const id = +e.currentTarget.closest('.week').dataset.id; completeWeek(id);
  });
  $$('.q .opt').forEach(o=> o.onclick = e=>{
    const ok = e.currentTarget.dataset.ok==='true';
    e.currentTarget.classList.add(ok?'correct':'wrong');
    const fb = e.currentTarget.closest('.q').querySelector('.feedback');
    fb.textContent = ok ? 'Correct — add this idea to your argument.' : 'Try again — check the agenda notes.';
  });

  // Drag & drop
  $$('.drag').forEach(el=>{
    el.addEventListener('dragstart', ev=>{ ev.dataTransfer.setData('text/plain', ev.target.textContent); })
  });
}

// Tilt effect
function applyTilt(){
  $$('.card-front').forEach(c=>{
    c.addEventListener('pointermove', e=>{
      const r=c.getBoundingClientRect();
      const x=(e.clientX - r.left)/r.width, y=(e.clientY - r.top)/r.height;
      const rx = (y-.5)*-12, ry = (x-.5)*12; c.style.transform=`rotateX(${rx}deg) rotateY(${ry}deg)`;
    });
    c.addEventListener('pointerleave', ()=> c.style.transform='rotateX(0) rotateY(0)');
  });
}

// Evidence board drop zones
$$('.drop').forEach(zone=>{
  zone.addEventListener('dragover', ev=> ev.preventDefault());
  zone.addEventListener('drop', ev=>{
    ev.preventDefault();
    const chip = document.createElement('span'); chip.className='drag'; chip.textContent = ev.dataTransfer.getData('text/plain');
    zone.appendChild(chip); toast('Added to '+ zone.dataset.slot);
  });
});

// Progress logic
const done = load('ilrlr_done', []);
function completeWeek(id){ if(!done.includes(id)){ done.push(id); save('ilrlr_done', done); updateProgress(); toast('Week '+id+' marked complete'); } }
function updateProgress(){ const pct = Math.round(done.length / data.length * 100); $('#progressMeter').value = pct; $('#progressText').textContent = pct + '% complete'; }

// Range filter
const range = $('#weekRange'); const label = $('#rangeLabel');
range.oninput = ()=>{ const v=+range.value; label.textContent = v===data.length? 'All weeks' : 'Through week '+v; renderWeeks(v); };

// Focus filter (simple highlighting)
$$('.panel [data-focus]').forEach(btn=>{
  btn.onclick = ()=>{
    const f = btn.dataset.focus; $$('.week').forEach(w=>{
      if(f==='all'){ w.style.opacity=1; return; }
      const id=+w.dataset.id; const has = data.find(d=>d.id===id).tags.includes(f);
      w.style.opacity = has? 1 : .35;
    });
  };
});

// Spinner
const wheel = $('#wheel'); let spinning=false;
$('#spinBtn').onclick = ()=>{
  if(spinning) return; spinning=true;
  const turns = 360*5 + Math.floor(Math.random()*360);
  wheel.style.transform = `rotate(${turns}deg)`;
  setTimeout(()=>{ spinning=false; toast('Prompt selected — build your argument!'); }, 3300);
};

// Language toggle — for now just UX cue
$('#enBtn').onclick = ()=>{ $('#enBtn').setAttribute('aria-pressed','true'); $('#esBtn').setAttribute('aria-pressed','false'); toast('English mode'); };
$('#esBtn').onclick = ()=>{ $('#enBtn').setAttribute('aria-pressed','false'); $('#esBtn').setAttribute('aria-pressed','true'); toast('Español pronto — content hooks ready'); };

// Reset local progress
document.getElementById('resetLocal').onclick = () => {
  done.splice(0, done.length);
  save('ilrlr_done', done);
  updateProgress();
  toast('Progress reset');
};

// Init
// Set the range max based on number of weeks
range.max = data.length;
range.value = data.length;
renderWeeks(); updateProgress();
</script>
</body>
</html>
